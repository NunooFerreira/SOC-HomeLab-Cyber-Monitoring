# SOC-Lab-Home-Cybersecurity-Monitoring
This project sets up a Security Operations Center (SOC) lab to simulate, detect, and mitigate cyberattacks using open-source security tools. Developed experience with threat detection, incident response, and system monitoring.

## Project Structure

| Component             | Purpose                                 |
|-----------------------|-----------------------------------------|
| **pfSense**           | Network firewall and traffic management |
| **Active Directory**  | Centralized user and domain management  |
| **Windows Workstation**| Simulates user endpoint for testing    |
| **Sysmon**            | Advanced logging for Windows events     |
| **CrowdSec**          | Detects and mitigates malicious activity|

### Network Configuration

| Device                 | IP Address       | Gateway        | Subnet Mask     | Zone    |
|------------------------|------------------|----------------|-----------------|---------|
| pfSense (Firewall)     | 192.168.10.1     | -              | 255.255.255.0   |         |
| Active Directory (SOC-AD1) | 192.168.10.10    | 192.168.10.1  | 255.255.255.0   | LAN  |
| Windows Workstation    | 192.168.10.20    | 192.168.10.1   | 255.255.255.0   | LAN     |
| Kali Linux             | 192.168.20.30    | 192.168.20.1   | 255.255.255.0   | DMZ     |


## Tools and Usage

1. **pfSense**: Acts as a network firewall to control and monitor traffic between virtual machines.
2. **Active Directory (AD)**: Manages users and devices in a centralized domain (soc.lab).
3. **Windows Workstation**: Simulates personal user machine to detect malicious activities.
4. **Sysmon**: Provides advanced event logging to monitor system-level activity on Windows.
5. **CrowdSec**: Detects and mitigates threats.
6. **[BadBlood](https://github.com/davidprowe/BadBlood)**: Populates the Active Directory with intentional Users and Groups with misconfigurations (e.g., weak passwords, excessive privileges) to simulate real-world vulnerabilities.  

## Attack Simulation Sequence

### 1. **RDP Brute-Force Attack**
   - **Target:** Windows 10 Workstation (IP: 192.168.10.20, RDP port 3389)
   - **Attack:** Using Hydra, a brute-force attack was launched against the RDP service to guess the correct password of a random user.
   - **Command:**
     ```
     hydra -L /usr/share/wordlists/common_users.txt -P /usr/share/wordlists/rockyou.txt rdp://192.168.10.20
     ```

### 2. **Kerberos-based SPN Extraction**
   - **Target:** Active Directory Domain Controller (IP: 192.168.10.10, Domain: SOC.LAB)
   - **Attack:** The attacker used the `GetUserSPNs.py` script from the Impacket toolkit to extract Service Principal Names (SPNs) and attempt to extract Kerberos Ticket Granting Service (TGS) hashes from the Active Directory.
   - **Cracking Hashes:** After extraction, the hashes were cracked offline using Hashcat with the rockyou.txt wordlist.
   - **Command to Crack Hashes:**
     ```
     hashcat -m 13100 spn_hash.txt /usr/share/wordlists/rockyou.txt --force -o cracked.txt
     ```

### 3. **RDP Access and Data Exfiltration**
   - **Target:** Windows Workstation (IP: 192.168.10.20)
   - **Attack:** After obtaining valid credentials through the previous attacks, the attacker gained remote access via RDP. Once inside, data was exfiltrated.
   
### 4. **Reverse Shell Backdoor with PowerShell Cradle Attack**
   - **Target:** Windows Workstation (IP: 192.168.10.20, Domain: SOC.LAB)
   - **Attack:** A malicious PowerShell script was created and executed to establish a reverse shell back to the Kali Linux machine.
   - **Payload:** The reverse shell allowed full control over the target machine, enabling the attacker to execute commands such as:
     - `whoami` (To confirm the user)
     - `tasklist` (To list running processes)
     - `net user` (To list user accounts)
     - `net user labadmin` (To get detailed information about a specific user)
   - **Steps to Deploy:**
     - Hosted the payload using an HTTP server on Kali.
     - Used Netcat to listen for incoming connections on port 4444.

## Conclusion
Throughout this project, a variety of attacks were simulated in a controlled environment to test the monitoring capabilities of the SOC lab. The key component was to observe logs generated by tools like Sysmon and CrowdSec to identify and mitigate these attacks in real-time. This simulation has greatly enhanced the ability to detect, respond to, and defend against sophisticated cyberattacks.
